## Data & AI - 推薦系統 RecSys 結業心得

同事隨手轉貼的報名連結讓我意外開啟了這段為期6週的旅程。

從每週二趕下班參加的線上工作坊，到每週日作業deadline前的緊張刺激感，讓我途中一度以為自己會跟不上這次的計畫。但我很開心自己跟到了最後。

做到了後再回頭看，原來我已經從推薦系統是幹什麼吃的、有哪幾種推薦方法都不知道的菜雞，成長到了解知曉其原理，各種常見推薦法的演算法概念，並能初步了解推薦系統對於企業效益與價值的程度。果然人是能逼出一些潛能的。

這門課其實如同計畫說明中所提的，不會教我們什麼python的撰寫技巧，課堂上也不會手把手帶著我們走過一次模型演算法，我們必須在對於資料型態、迴圈等概念有所掌握的基礎下，在看了影片&講解後去實作並迭代幾種不同的推薦系統。

但AC為我們帶來的價值是能夠在show & tell上觀摩許多大神同學們的寫法和MD、能夠聽到Bernard想帶給我們的商業思維邏輯、並能夠在最後兩週聽著Richard各種超時又超精彩的實務分享，這些都是在參加前我沒有想到會得到的。

很開心能透過這次計畫中用0到1的方式，打造自己人生第一個的推薦系統。不管是最基礎的rule-based、content-based，還是更為fancy的collaborative filtering，我都在這次計畫中接觸到了。而也在過程中驚覺，原來在許多實務場景中，複雜的演算法不一定帶來較好的結果，在不少情況下還真的是TSTB(the simpler the better)，能在最後的icook專案中發現這件事，是我重要的takeaway！

當然這不是終點，在跟完這次計畫後，我發現自己在商業邏輯知識與資料處理技巧上都有所不足，距離專業還有好大一段距離。但這次的計畫，也成為了我的敲門磚，讓我更清楚知道自己不會什麼，並也督促自己設法去找資源學習。感謝用心推出計畫的AC團隊，以及努力跟到最後的自己。


> ---
## 實作 rule-based、content-based及collaborative filtering(hybrid) 的推薦系統

### 一、專案目的：
根據使用者過去的商品購買紀錄/商品資訊，建立一個推薦系統，以推薦未來使用者合適的商品。


### 二、使用工具：
1. 資料：來自 2014 年 Amazon 發布的資料集

    * 購買記錄(All_Beauty)：2000-01-10 to 2018-10-02 (371345 筆)
      * 訓練資料：2000-01-10 to 2018-09-01 (370752 筆)
      * 測試資料：2018-09-01 to 2018-09-30 (590 筆)
 
    * 商品資訊(meta_All_Beauty)：32892 筆

2. 使用套件：pandas, numpy, datetime, surprise, itertools, collections


### 三、推薦方法說明：

Week 1:
   1. 思考過程

     * 原先希望能透過使用者過去的購買紀錄，推薦其同品牌(brand)的高評價商品，或是推薦商品資訊中的其他相關商品(also_buy)；探索後發現在590筆測試資料中，發現僅38位使用者曾在訓練資料中出現，因此此方法可能不適用。
     * 衡量後採用兩種方法進行嘗試，兩種方法皆綜合過去的銷售或評分紀錄作為推薦規則

   2. 推薦規則

     * 做法一：推薦熱門程度最高的前10項商品 (熱門程度定義：所有評分紀錄加總) 
     * 做法二：推薦最近一個月銷量排行前十名的商品


Week 2:
   1. 思考過程

     * 結合 Content-based 與 Rule-based 兩種篩選方式進行推薦
     * 僅取最近一個月的購買紀錄作為訓練資料
     * 嘗試推薦相似的商品給曾購買過商品的使用者(Content-Based)；不足K個或是未曾購買的使用者則推薦熱銷和評分高的商品

   2. 推薦規則

     * Rule-based：以銷售數量與評分平均數為判斷依據，以銷售數量為主、評分平均數為輔排序) 
     * Content-based：以相似程度(餘弦距離)排序


Week 3:
   1. 思考過程

     * 以 User-based 與 Item-based 的協同過濾，結合 rule-based 推薦法來進行推薦
     * 為了比前幾週更了解在不同推薦商品數及不同的時間區間下的結果，在結果評估的部分用迴圈的方式來計算個情況下的分數
   
   2. 推薦規則

     * User-based: 根據各使用者對於商品的評價，計算各使用者之間的cosine similarity
     * Item-based: 根據各商品被使用者的評價，計算各商品之間的cosine similarity
     * surprise套件: 使用KNNBasic演算法

### 四、推薦結果：

Week 1:
   1. 評估分數(Recall)：

     * 做法一： 0.083051
     * 做法二： 0.154237

   2. 實作後想法：看起來比起考慮所有歷史銷量與評分的推薦規則，以近一個月的銷量排行來進行推薦會更準一些，但兩者皆仍有很大的優化空間。


Week 2:
   1. 評估分數(Recall)：
 
     * 0.157627

   2. 實作後想法：納入Content-Based的推薦方法後比起僅用Rule-Based的推薦方式又更準確一些，但皆仍有很大的優化空間。


Week 3:
   1. 評估分數(Recall):

     * 在推薦數為10(k=10)的條件下，最佳的分數為 0.1576 (User-based & rule-based hybrid)

   2. 實作後想法：雖然此次使用協同過濾的方法結合rule-based進行推薦，但由於測試資料中幾乎都是新的使用者，結果明顯受到冷啟動的影響，導致結果與單純用rule-based不會相差太多。冷啟動是個難題。

